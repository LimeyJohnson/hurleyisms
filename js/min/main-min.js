$(document).ready(function(){function n(n){var e=$("section."+n);e.hasClass("active")||($("section.active").removeClass("active"),e.addClass("active"))}function e(){$(".line-added").addClass("fade-in"),$("#the-line").val(""),i($("body"))}function i(n){$("html, body").animate({scrollTop:n.offset().top},250)}function t(){o(),r(),b(),g()}function o(){var n;A===N.MEN&&(n="men"),A===N.WOMEN&&(n="women"),A===N.KIDS&&(n="kids"),$("span.audience").text(n)}function r(){var n=a();p(n)}function a(){for(var n=s()?1:5,e=[],i=[],t=!1,o=$("main .line").first(),r=0;n>r;r++){for(var a;;)if(a=l(),c(a.id,i)){i.push(a.id),e.push(a);break}if(0===o.length&&(o=u()),h(a,o),t=d(o))break;o=o.next()}return e}function s(){return window.matchMedia("(max-width: 568px)").matches}function l(){var n=Math.floor(Math.random()*P.length);return P[n]}function c(n,e){return-1===e.indexOf(n)}function u(){return $("#lines .line:last-child").clone().appendTo("#lines")}function h(n,e){e.find(".line__text").html(n.line),e.find(".line__byline .author").text(n.author)}function d(n){return f(n)?(s()?m(n):n.remove(),!0):!1}function f(n){var e=n[0].getBoundingClientRect(),i=$(".lines__footer").height()+$("#progress-bar").height(),t=window.innerHeight-i;return e.bottom>t}function m(n){for(var e=n.children(".line__text").css("font-size"),i=parseInt(e,10);f(n);)i-=2,n.children(".line__text").css("font-size",i)}function p(n){D=n.map(function(n){return n.line.length}).reduce(function(n,e){return n+e})}function b(){O=$("input[type=range]").val()}function g(){W=requestAnimationFrame(k)}function v(){cancelAnimationFrame(W)}function y(){v(),M=null,T.width(0)}function k(n){var e=w(n);e>100&&(e=0,C());var i=e+"%";T.css("width",i),M=n,g()}function w(n){M||(M=n);var e=n-M,i=T.width()/E.width()*100,t=s()?1:3,o=t*O*e/D;return i+o}function C(){_(),x(),r(),i($("body"))}function _(){$(".thumbs-up.active, .thumbs-down.active").removeClass("active")}function x(){$("#lines .line__text").removeAttr("style")}function H(){y(),T.width(0),C(),$(".pause").hasClass("is-paused")||g()}var P=[{id:0,line:"Flare your right nostril...<br/><br/>Wait, you did both.  Just the right one.",men:!0,women:!0,kids:!0,profanity:!1,rating:0,author:"Peter Hurley"},{id:1,line:"Don't get ahead of yourselfâ€“ you'll get ahead of me!",men:!0,women:!0,kids:!0,profanity:!1,rating:0,author:"Peter Hurley"},{id:2,line:"Look like you WON the marathon.<br/><br/>Now look like you LOST the marathon.",men:!0,women:!0,kids:!1,profanity:!1,rating:0,author:"Peter Hurley"},{id:3,line:"Think like a pedestrian!",men:!0,women:!0,kids:!1,profanity:!1,rating:0,author:"Peter Hurley"},{id:4,line:"Look like you're operating from a different train of thought!",men:!0,women:!0,kids:!1,profanity:!1,rating:0,author:"Peter Hurley"},{id:5,line:"TWILCH to the left!...<br/><br/>Ahh, so THAT'S what a twilch is!",men:!0,women:!0,kids:!0,profanity:!1,rating:0,author:"Peter Hurley"},{id:6,line:"Smirch up a bit.  That's the PERFECT amount of smirch!<br/><br/>Now DOUBLE the smirch.  Ahh, smirchfection!",men:!0,women:!0,kids:!0,profanity:!1,rating:0,author:"Peter Hurley"},{id:7,line:"Forehead UP, chin DOWN, forehead UP, chin DOWN...<br/><br/>Why are you nodding?",men:!0,women:!0,kids:!0,profanity:!1,rating:0,author:"Peter Hurley"}],N={MEN:0,WOMEN:1,KIDS:2},E=$("#progress-bar"),T=$("#progress-bar__fill"),A,O,W,M,D;$("a.begin-session").click(function(){A=Number($(this).attr("data-audience-type")),n("lines"),t()}),$(".switch").click(function(){$(this).toggleClass("active")}),$(".btn.add-line").click(function(){n("submit")}),$("section.submit a.close").click(function(){n("splash")}),$("section.submit .add-line").click(function(){$(".error").remove();var n=" <span class='error'>Required</span>";if(""===$("#the-line").val()&&$("label[for=the-line]").append(n),0===$(".checkbox-list input:checked").length&&$(".form-control--audience .form-control__label").append(n),0===$(".error").length)e();else{var t=$(".error").first();i(t)}}),$("body").on("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){$(".line-added").removeClass("fade-in")}),$(window).on("swipeleft",function(){H()}),$("section.lines a.close").click(function(){n("splash"),y()}),$(document).on("click",".thumbs-up, .thumbs-down",function(){$(this).toggleClass("active"),$(this).hasClass("active")&&$(this).siblings(".btn.active").removeClass("active")}),$("input[type=range]").change(function(){O=$(this).val()}),$(".pause").click(function(){$(this).toggleClass("is-paused"),$(this).hasClass("is-paused")?v():g()}),$(".next").click(function(){H()})});