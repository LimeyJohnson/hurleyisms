var configuration=function(){var e={stripe_pk:"pk_test_p43Roytjpdw7yHKTMppmOy2k"};return e}(),auth=function(){var e={},t=function(){var e=$("#signup-modal input[type=email]").emailify()&&$("#signup-modal input[required]").requirify(),t=$("#chk_terms").requirifyCheck("You must accept the terms and privacy policy");return t&&e};e.register=function(e){if(e.preventDefault(),t()){var i={};i.email=$("#email").val(),i.password=$("#password").val(),i.name=$("#name").val();var o=$("#coupon-code").val();o&&(i.couponcode=o),$.post("auth/register",i).done(function(e){$.openModal("checkout-modal")}).error(function(e){$("#signup-modal input[type=email]").addError("This email has already been taken.  <a href='#' data-modal='login-modal'>Login</a> if it's yours")})}};var i=function(){return $("#login-modal input[type=email]").emailify()&&$("#login-modal input[required]").requirify()};e.login=function(){if(i){var e={};e.email=$("#login__email-address").val().toLowerCase(),e.password=$("#login__password").val(),$.post("auth/login",e).done(function(e){document.location.href="/app"}).error(function(e){$("#login-modal input[type=email]").addError("Email or password incorrect")})}},e.logout=function(){$.post("auth/logout").done(function(){document.location.href="/"})},e.cancel=function(e){$.post("auth/cancel").done(function(){e&&e()})},e.updateEmailAddress=function(e,t){$.post("auth/email",{email:e}).done(function(){t()})},e.updatePassword=function(e,t){$.post("auth/password",{password:e}).done(function(){t&&t()})},e.forgotPassword=function(e,t){$.post("auth/forgotPassword",{email:e}).done(function(){t&&t()})},e.isLoggedIn=function(){var e=o();if(e){var t=JSON.parse(window.atob(e.split(".")[1]));return t.exp>Date.now()/1e3}return!1},e.isAdmin=function(){var e=o();if(e){var t=JSON.parse(window.atob(e.split(".")[1]));return t.exp>Date.now()/1e3&&t.admin}return!1},e.isMonthly=function(){var e=o();if(e){var t=JSON.parse(window.atob(e.split(".")[1]));return t.exp>Date.now()/1e3&&"monthly"===t.type}return!1},e.isLifeTime=function(){var e=o();if(e){var t=JSON.parse(window.atob(e.split(".")[1]));return t.exp>Date.now()/1e3&&"lifetime"===t.type}return!1},e.loggedInEmail=function(){var e=o();if(e){var t=JSON.parse(window.atob(e.split(".")[1]));return t.exp>Date.now()/1e3?t.email:null}return null},e.hasVerifiedEmail=function(){var e=o();if(e){var t=JSON.parse(window.atob(e.split(".")[1]));return t.exp>Date.now()/1e3?t.emailverified:null}return null},e.proDate=function(){var e=o();if(e){var t=JSON.parse(window.atob(e.split(".")[1]));return t.exp>Date.now()/1e3?new Date(t.prodate):null}return null},e.isPro=function(){var e=o();if(e){var t=JSON.parse(window.atob(e.split(".")[1]));return t.exp>Date.now()/1e3?t.pro:null}return null};var o=function(){return getCookie("auth")};return getCookie=function(e){for(var t=e+"=",i=document.cookie.split(";"),o=0;o<i.length;o++){for(var n=i[o];" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return null},e}();$(function(){$("#btn_register").click(auth.register),$("#btn_login").click(auth.login),$("#login-modal input[type=password]").keyup(function(e){13==e.keyCode&&auth.login()}),$("#btn_newPassword").click(function(e){var t=$("#new-password__password").val();t&&auth.updatePassword(t,function(){$.closeModal(),$.createToast("Your password has been updated")})}),$("#btn_verifyPass").click(function(e){var t=$("#forgot__email-address").val();t&&auth.forgotPassword(t,function(){$.closeModal(),$.createToast("A password reset link has been sent to you")})}),$("#btn_newPassword").click(function(e){var t=$("#new-password__password").val();t&&auth.updatePassword(t,function(){$.closeModal(),$.createToast("Your password has been updated")})})}),jQuery.fn.extend({addError:function(e,t){var i=e||"This field is invalid";return this.each(function(){t=t||"",t.length&&(t=" "+t),$(this).next(".error").remove(),$(this).after("<div class='error"+t+"'>"+i+"</div>")})},removeError:function(){return this.each(function(){$(this).next(".error").remove()})},isTextField:function(){return $(this).first().is("input[type=text], input[type=email], input[type=password], textarea")},toggleText:function(e,t){return this.each(function(){var i=$(this).text();i===e?$(this).text(t):i===t&&$(this).text(e)})},hasError:function(){return $(this).first().next().hasClass("error")},requirify:function(e){var t=e||"This is a required field",i=!0;return this.each(function(){return 0===$(this).val().length?($(this).addError(t),i=!1,!1):void $(this).removeError()}),i},requirifyCheck:function(e){var t=e||"This is a required field",i=!0;return this.each(function(){return $(this).is(":checked")?void $(this).removeError():($(this).addError(t),i=!1,!1)}),i},emailify:function(e){function t(e){var t=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;return t.test(e)}var i=e||"Please enter a valid email address";return t($(this).val())?($(this).removeError(),!0):($(this).addError(i),!1)},footerify:function(e){if(!e.bodyWrapper||!e.footer)return!1;var t=e.bodyWrapper,i=e.footer,o=$("footer").outerHeight();$(".body-wrapper").css("min-height","100%").css("margin-bottom","-"+o+"px")},showPasswordify:function(e){return this.each(function(){if("undefined"==typeof e.control)return!1;var t=$(this),i=e.control,o=e.showText||"Show",n=e.hideText||"Hide";i.click(function(){"text"===t.prop("type")?(t.prop("type","password"),i.text(o)):"password"===t.prop("type")&&(t.prop("type","text"),i.text(n))})})},simpleEditify:function(e){var t=$.extend({onOpen:function(){},onClose:function(){},onSaveSuccess:function(){}},e);return this.each(function(){function i(e){var i=e.find("input");i.data("initial-value",i.val()).removeAttr("disabled").focus(),e.find(".simple-edit__edit").toggleText("Edit","Save").toggleClass("btn--blue btn--green simple-edit__edit simple-edit__save"),t.onOpen()}function o(e){var i=e.find("input"),o=i.data("initial-value");i.val(o),i.prop("disabled",!0),e.find(".simple-edit__save").toggleText("Edit","Save").toggleClass("btn--blue btn--green simple-edit__edit simple-edit__save"),t.onClose()}function n(e){return!e.hasError()&&(e.find("input").prop("disabled",!0),e.find(".simple-edit__save").toggleText("Edit","Save").toggleClass("btn--blue btn--green simple-edit__edit simple-edit__save"),t.onClose(),void t.onSaveSuccess())}$(this).on("click",".simple-edit__edit",function(){var e=$(this).closest(".simple-edit");i(e)}),$(this).on("keyup",".simple-edit__input",function(e){if(27===e.which){var t=$(this).closest(".simple-edit");o(t)}}),$(this).on("keydown",".simple-edit__input",function(e){if(13===e.which&&e.metaKey){var t=$(this).closest(".simple-edit");n(t)}}),$(this).on("click",".simple-edit__save",function(){if(0===$(this).find(".error").length){var t=$(this).closest(".simple-edit"),i=function(){n(t)};e.onSave?e.onSave(i):i()}})})}}),$.createToast=function(e,t,i){function o(e){return window.getComputedStyle(e[0]).opacity}var n=t||3e3;i=i||"",$("body").append("<div class='toast "+i+"'>"+e+"</div>");var a=$(".toast");o(a),a.addClass("appear"),setTimeout(function(){a.removeClass("appear").on("transitionend",function(){$(this).remove()})},n)},$(document).ready(function(){$("a[href=#]").click(function(e){e.preventDefault()}),$(document).on("click","a[data-modal]",function(e){window.lifetime=!1,$(this).is("[lifetime]")&&(window.lifetime=!0),$(this).closest(".line").length>0&&(window.editid=$(this).closest(".line").attr("name"));var t=$(this).attr("data-modal");$.openModal(t)}),$.openModal=function(e){if($("body").hasClass("has-modal-open")&&$.closeModal(),auth&&auth.isLoggedIn()&&"signup-modal"===e)auth.isPro()?console.error("already pro"):stripe.launch();else{var t=$(".modal").filter("#"+e);t.addClass("is-visible"),$("body").addClass("has-modal-open")}},$(".modal a.modal__close").click(function(){$.closeModal()}),$(".modal").click(function(e){$(e.toElement).is(".modal:not(.modal--uncloseable)")&&$.closeModal()}),$(document).keyup(function(e){27===e.keyCode&&$("body").hasClass("has-modal-open")&&$.closeModal()}),$.closeModal=function(){$(".modal.is-visible").removeClass("is-visible"),$("body").removeClass("has-modal-open")}}),function(e,t,i,o,n,a,r){e.GoogleAnalyticsObject=n,e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},e[n].l=1*new Date,a=t.createElement(i),r=t.getElementsByTagName(i)[0],a.async=1,a.src=o,r.parentNode.insertBefore(a,r)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-77534503-1","auto"),ga("send","pageview");var stripe=function(){var e={};e.handler=StripeCheckout.configure({key:configuration.stripe_pk,image:"images/apple-touch-icon-120.png",locale:"auto",zipCode:!0,token:function(e){var t=window.lifetime?"auth/lifetime":"auth/monthly";$.post(t,{token:e.id}).done(function(e){$.createToast("Thanks for joining Hurleyisms Pro.  We're redirecting you <a href='app'>back to the app</a> in a few seconds",5e3),console.log("redirecting"),setTimeout(function(){document.location.href="/app"},5e3)}).error(function(e){$.createToast("There was a problem processing your card. Please <a href='javascript:stripe.launch()'>try again</a>",1e4)})}});var t=function(e,t){$.get("auth/amount/"+e).done(function(e){e.amount||console.error("did not get amount back"),t(parseInt(e.amount))})};return e.launch=function(t){t&&t.preventDefault(),$.closeModal(),window.lifetime?e.launchlifetime(auth.loggedInEmail()):e.launchmonthly(auth.loggedInEmail())},e.launchlifetime=function(i){var o=9900;t(o,function(t){e.handler.open({name:"Hurleyisms",description:"Lifetime Access",amount:t,zipCode:!0,email:i})})},e.launchmonthly=function(i){var o=499;t(o,function(t){e.handler.open({name:"Hurleyisms",description:"Monthly Subscription",amount:t,zipCode:!0,email:i})})},$(window).on("popstate",function(){e.handler.close()}),e}();$(document).ready(function(){$("body").footerify({bodyWrapper:$(".body-wrapper"),footer:$("footer")}),$("input[type=email]").val(auth.loggedInEmail()),$("input[type=email], input[type=password]").requirify(),$("input[type=email]").emailify(),$("input[type=password]").showPasswordify({control:$(".show-password")}),$("#email").simpleEditify({onSaveSuccess:function(){$.createToast("New email address saved!  Check your inbox for Hurleyisms's message to confirm this email is yours.")},onSave:function(e){var t=$("input[type=email]").val();updateEmailAddress(t,e)}}),$("#password").simpleEditify({onOpen:function(){$("input[type=password]").val(""),$(".show-password").removeClass("hidden")},onClose:function(){$("input[type=password]").val("password"),$(".show-password").addClass("hidden")},onSaveSuccess:function(){$.createToast("New password saved!")},onSave:function(e){if($("input[type=password]").requirify()){var t=$("input[type=password]").val();updatePassword(t,e)}}}),$(document).keyup(function(e){84===e.which&&$("body").toggleClass("is-monthly is-lifetime")}),$(".show-password").click(function(){$(this).toggleText("Show password","Hide password")});var e=function(){$("body").toggleClass("is-monthly",auth.isMonthly()),$("body").toggleClass("is-lifetime",auth.isLifeTime()),auth.isLifeTime()||auth.isMonthly()?$(".if-purgatory").hide():($("#lifetime").hide(),$("#monthly").hide(),$("#cancle").hide(),$(".if-purgatory").show())};e();var t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],i=auth.proDate();$(".started").html("Started "+t[i.getMonth()]+" "+i.getFullYear()),$("#logout").click(auth.logout),$("#cancel").click(function(){auth.cancel(function(){$.closeModal(),e(),$.createToast("Your monthly subscriptions has been cancled",1e4)})}),$("#btnLifeTime").click(function(){stripe.launchlifetime(auth.loggedInEmail())}),$(".privacy").click(function(){window.open("/privacy")}),$(".terms").click(function(){window.open("/terms")})});